generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model UserWords {
  id             String             @id @default(cuid())
  wordId         String
  word           Words              @relation(fields: [wordId], references: [id])
  learningStatus Int                @default(0)
  authorId       String
  author         Profiles?          @relation(fields: [authorId], references: [id])
  createdDate    DateTime           @default(now())
  updatedDate    DateTime           @default(now()) @updatedAt
  Dictionary     DictAndUserWords[]
}

model Dictionaries {
  id          String             @id @default(cuid())
  title       String
  subscribers Int                @default(0)
  published   Boolean            @default(false)
  authorId    String
  author      Profiles?          @relation(fields: [authorId], references: [id])
  createdDate DateTime           @default(now())
  updatedDate DateTime           @default(now()) @updatedAt
  UserWords   DictAndUserWords[]
  SubDics     SubscribedDics[]
}

model Profiles {
  id             String           @id
  username       String?
  name           String
  avatar_url     String?
  nativeLanguage String?
  targetLanguage String?
  createdDate    DateTime         @default(now())
  updatedDate    DateTime         @default(now()) @updatedAt
  UserWords      UserWords[]
  Dictionaries   Dictionaries[]
  SubDics        SubscribedDics[]
}

model SubscribedDics {
  profile      Profiles     @relation(fields: [profileId], references: [id])
  profileId    String
  Dictionary   Dictionaries @relation(fields: [dictionaryId], references: [id])
  dictionaryId String
  createdDate  DateTime     @default(now())
  updatedDate  DateTime     @default(now()) @updatedAt

  @@id([profileId, dictionaryId])
}

model Words {
  id             String      @id @default(cuid())
  text           String
  status         Int         @default(0)
  translatedText String
  nativeLanguage String
  targetLanguage String
  createdDate    DateTime    @default(now())
  updatedDate    DateTime    @default(now()) @updatedAt
  UserWords      UserWords[]
}

model DictAndUserWords {
  userWord     UserWords    @relation(fields: [userWordId], references: [id])
  userWordId   String
  Dictionary   Dictionaries @relation(fields: [dictionaryId], references: [id])
  dictionaryId String
  createdDate  DateTime     @default(now())
  updatedDate  DateTime     @default(now()) @updatedAt

  @@id([userWordId, dictionaryId])
}

model SubscribedUsers {
  id          String   @id @default(cuid())
  email       String
  createdDate DateTime @default(now())
  updatedDate DateTime @default(now()) @updatedAt
}
